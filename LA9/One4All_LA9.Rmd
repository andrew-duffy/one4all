---
title: "One4All_LA9"
author: "Braden Griebel, Luke Fanning, Andrew Duffy, Ahyo Falick"
date: "10/23/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
factbook<-read_delim("factbook.csv",delim=";",col_types = cols(
  Country=col_character(),
  `Area(sq km)`=col_double(),
  `Birth rate(births/1000 population)`=col_double(),
  `Current account balance`=col_double(),
  `Death rate(deaths/1000 population)`=col_double(),
  `Debt - external`=col_double(),
  `Electricity - consumption(kWh)`=col_double(),
  `Electricity - production(kWh)`=col_double(),
  `Exports`=col_double(),
  `GDP`=col_double(),
  `GDP - per capita`=col_double(),
  `GDP - real growth rate(%)`=col_double(),
  `HIV/AIDS - adult prevalence rate(%)`=col_double(),
  `HIV/AIDS - deaths`=col_double(),
  `HIV/AIDS - people living with HIV/AIDS`=col_double(),
  `Highways(km)`=col_double(),
  `Imports`=col_double(),
  `Industrial production growth rate(%)`=col_double(),
  `Infant mortality rate(deaths/1000 live births)`=col_double(),
  `Inflation rate (consumer prices)(%)`=col_double(),
  `Internet hosts`=col_double(),
  `Internet users`=col_double(),
  `Investment (gross fixed)(% of GDP)`=col_double(),
  `Labor force`=col_double(),
  `Life expectancy at birth(years)`=col_double(),
  `Military expenditures - dollar figure`=col_double(),
  `Military expenditures - percent of GDP(%)`=col_double(),
  `Natural gas - consumption(cu m)`=col_double(),
  `Natural gas - exports(cu m)`=col_double(),
  `Natural gas - imports(cu m)`=col_double(),
  `Natural gas - production(cu m)`=col_double(),
  `Natural gas - proved reserves(cu m)`=col_double(),
  `Oil - consumption(bbl/day)`=col_double(),
  `Oil - exports(bbl/day)`=col_double(),
  `Oil - imports(bbl/day)`=col_double(),
  `Oil - production(bbl/day)`=col_double(),
  `Oil - proved reserves(bbl)`=col_double(),
  `Population`=col_double(),
  `Railways(km)`=col_double(),
  `Public debt(% of GDP)`=col_double(),
  `Reserves of foreign exchange & gold`=col_double(),
  `Telephones - main lines in use`=col_double(),
  `Telephones - mobile cellular`=col_double(),
  `Total fertility rate(children born/woman)`=col_double(),
  `Unemployment rate(%)`=col_double()
))
factbook<-factbook[2:264,]
colnames(factbook)
```
These data comes from the CIA, however they don't provide an csv file download, so the actual csv file was obtained from https://perso.telecom-paristech.fr/eagan/class/igr204/datasets

# Codebook:
  * Country=Name of country
  
  * Area(sq km)=Country area in square kilometers
  
  * Birth rate(births/1000 population)=Number of births in a year per 1000 people in country,
  
  * Current account balance=Current account balance compares a country's net trade in goods and services, plus net earnings, and           net transfer payments to and from the rest of the world during the period specified. These figures are calculated on an          exchange rate basis.
  
  * Death rate(deaths/1000 population)=Deaths per year per 1000 population,
  
  * Debt - external=Debt owed to creditors outside country,
  
  * Electricity - consumption(kWh)=Electricity consumed by country kilowatt hours,
  
  * Electricity - production(kWh)=Electricity produced in kilowatt hours,
  
  * Exports=Total value of exports in USD,
  
  * GDP=Gross domestic product in USD,
  
  * GDP - per capita=GDP per person in USD,
  
  * GDP - real growth rate(%)=Inflation adjusted rate of GDP growth per year,
  
  * HIV/AIDS - adult prevalence rate(%)=Percent of Adults with HIV,
  
  * HIV/AIDS - deaths=Number of deaths per year from HIV/AIDS,
  
  * HIV/AIDS - people living with HIV/AIDS=Number of adults with HIV/AIDS,
  
  * Highways(km)=Total length of highways in kilometers,
  
  * Imports=Total value of imports in USD,
  
  * Industrial production growth rate(%)=Industrial production growth rate compares the annual percentage increase in industrial           production (includes manufacturing, mining, and construction).,
  
  * Infant mortality rate(deaths/1000 live births)=Infant death per 1000 live births,
  
  * Inflation rate (consumer prices)(%)=Rate of inflation in cost of consumer products,
  
  * Internet hosts=Number of internet hosts in country,
  
  * Internet users=Number of internet users in country,
  
  * Investment (gross fixed)(% of GDP)=This entry records total business spending on fixed assets, such as factories, machinery,          equipment, dwellings, and inventories of raw materials, which provide the basis for future production. It is measured            gross of the depreciation of the assets, i.e., it includes investment that merely replaces worn-out or scrapped                  capital.,
  
  * Labor force=This entry contains the total labor force figure.,
  
  * Life expectancy at birth(years)=This entry contains the average number of years to be lived by a group of people born in the          same year, if mortality at each age remains constant in the future. Life expectancy at birth is also a measure of overall        quality of life in a country and summarizes the mortality at all ages. It can also be thought of as indicating the               potential return on investment in human capital and is necessary for the calculation of various actuarial measures.,
  * Military expenditures - dollar figure=total military expenditure,
  
  * Military expenditures - percent of GDP(%)=This entry gives spending on defense programs for the most recent year available as a           percent of gross domestic product (GDP); the GDP is calculated on an exchange rate basis, i.e., not in terms of                  purchasing power parity (PPP). For countries with no military forces, this figure can include expenditures on public             security and police.,
  
  * Natural Gas and Oil
      + consumption=amount of oil or natural gas consumed, cubic meters for natural gas, billion barrels/day for Oil
      + exports=amount sent to other countries, in same units
      + imports=amount brought in from other countries, in same units
      + production=amount produced
      + proved reserves=This entry is the stock of proved reserves of natural gas in cubic meters (cu m) or oil in billions of                 barrels. Proved reserves are those quantities of natural gas or oil, which, by analysis of geological and                        engineering data, can be estimated with a high degree of confidence to be commercially recoverable from a given                  date forward, from known reservoirs and under current economic conditions.
        
      + Natural gas - consumption(cu m)
      
      + Natural gas - exports(cu m)
      
      + Natural gas - imports(cu m)
      
      + Natural gas - production(cu m)
      
      + Natural gas - proved reserves(cu m)
      
      + Oil - consumption(bbl/day)
      
      + Oil - exports(bbl/day)
      
      + Oil - imports(bbl/day)
      
      + Oil - production(bbl/day)
      
      + Oil - proved reserves(bbl)
      
  * Population=This entry gives an estimate from the US Bureau of the Census based on statistics from population censuses, vital             statistics registration systems, or sample surveys pertaining to the recent past and on assumptions about future                 trends. The total population presents one overall measure of the potential impact of the country on the world and                within its region. Note: Starting with the 1993 Factbook, demographic estimates for some countries (mostly African)              have explicitly taken into account the effects of the growing impact of the HIV/AIDS epidemic. These countries are               currently: The Bahamas, Benin, Botswana, Brazil, Burkina Faso, Burma, Burundi, Cambodia, Cameroon, Central African               Republic, Democratic Republic of the Congo, Republic of the Congo, Cote d'Ivoire, Ethiopia, Gabon, Ghana, Guyana,                Haiti, Honduras, Kenya, Lesotho, Malawi, Mozambique, Namibia, Nigeria, Rwanda, South Africa, Swaziland, Tanzania,                Thailand, Togo, Uganda, Zambia, and Zimbabwe.,
  
  * Railways(km)=This entry states the total route length of the railway network and of its component parts by gauge, which is the           measure of the distance between the inner sides of the load-bearing rails. The four typical types of gauges are: broad,           standard, narrow, and dual. Other gauges are listed under note. Some 60% of the world's railways use the standard gauge           of 1.4 m (4.7 ft). Gauges vary by country and sometimes within countries. The choice of gauge during initial                     construction was mainly in response to local conditions and the intent of the builder. Narrow-gauge railways were                cheaper to build and could negotiate sharper curves, broad-gauge railways gave greater stability and permitted higher            speeds. Standard-gauge railways were a compromise between narrow and broad gauges.,
  
  * Public debt(% of GDP)=This entry records the cumulative total of all government borrowings less repayments that are denominated           in a country's home currency. Public debt should not be confused with external debt, which reflects the foreign                  currency liabilities of both the private and public sector and must be financed out of foreign exchange earnings.,
  
  * Reserves of foreign exchange & gold=This entry gives the dollar value for the stock of all financial assets that are available           to the central monetary authority for use in meeting a country's balance of payments needs as of the end-date of the             period specified. This category includes not only foreign currency and gold, but also a country's holdings of Special            Drawing Rights in the International Monetary Fund, and its reserve position in the Fund.,
  
  * Telephones - main lines in use=This entry gives the total number of fixed telephone lines in use,
  
  * Telephones - mobile cellular=This entry gives the total number of mobile cellular telephone subscribers,
  
  * Total fertility rate(children born/woman)=This entry gives a figure for the average number of children that would be born per           woman if all women lived to the end of their childbearing years and bore children according to a given fertility rate at          each age. The total fertility rate (TFR) is a more direct measure of the level of fertility than the crude birth rate,           since it refers to births per woman. This indicator shows the potential for population change in the country. A rate of          two children per woman is considered the replacement rate for a population, resulting in relative stability in terms of          total numbers. Rates above two children indicate populations growing in size and whose median age is declining. Higher           rates may also indicate difficulties for families, in some situations, to feed and educate their children and for women          to enter the labor force. Rates below two children indicate populations decreasing in size and growing older. Global             fertility rates are in general decline and this trend is most pronounced in industrialized countries, especially Western          Europe, where populations are projected to decline dramatically over the next 50 years.,
  
  * Unemployment rate(%)=This entry contains the percent of the labor force that is without jobs. Substantial underemployment might          be noted.

## Braden Griebel Individual Section:
**Question:** What is the relationship between length of highways and railroads, when controlling for land area and wealth measured by GDP per capita, and what affect does the ratio have with the oil consumption of the country?

Note that the countries were divided between the three categories based on the 33rd and 66th percentiles (1/3 and 2/3) of the Area of a country. So small countries were those with less than 3962.8 sq km, medium were between 3962.8 and 184848.8, and large were any countries that were larger than that. Small countries were mostly ancient cities and other outliers, with large numbers of NA for all the variables. Thus the data for small countries is not very useful, and mostly just eliminated from the rest of the data. 

```{r}
bfactbook<-factbook%>%mutate("ratio"=`Railways(km)`/`Highways(km)`)%>%
  mutate("GDP_fac"=
  ifelse(`GDP - per capita`<=10000,0,
         ifelse(`GDP - per capita`>10000&`GDP - per capita`<=20000,10,
         ifelse(`GDP - per capita`>20000&`GDP - per capita`<=30000,20,
         ifelse(`GDP - per capita`>30000&`GDP - per capita`<=40000,30,
         ifelse(`GDP - per capita`>40000&`GDP - per capita`<=50000,40,
         ifelse(`GDP - per capita`>50000,50,NA)))))))%>%
  mutate("area_fac"=
           ifelse(`Area(sq km)`<= 3962.8,"small",
                  ifelse(`Area(sq km)`> 3962.8&`Area(sq km)`<=184848.8,"medium",
                         ifelse(`Area(sq km)`>184848.8,"large",NA)))) 

large<-bfactbook%>%filter(area_fac=="large")
medium<-bfactbook%>%filter(area_fac=="medium")
small<-bfactbook%>%filter(area_fac=="small")
ggplot(large)+geom_jitter(aes(`Highways(km)`,`Railways(km)`,color=as.factor(GDP_fac)))+
  facet_wrap(~area_fac)+
  geom_smooth(method=lm,aes(`Highways(km)`,`Railways(km)`,color=as.factor(GDP_fac)),se=F)+coord_cartesian(xlim=c(184848.8,2e+06))+
  labs(title='Highways and Railroad in Large countries',color="Categorical GDP per capita in Thousands",
       caption="GDP per capita between 0 and 10000 represented by 0, between 10000 and 20000 by a 10 etc")
ggplot(medium)+geom_jitter(aes(`Highways(km)`,`Railways(km)`,color=as.factor(GDP_fac)))+
  facet_wrap(~area_fac)+
  geom_smooth(method=lm,aes(`Highways(km)`,`Railways(km)`,color=as.factor(GDP_fac)),se=F)+coord_cartesian(xlim=c(3962.8,184848.8))+
  labs(title='Highways and Railroad in Medium countries',color="Categorical GDP per capita in Thousands",
       caption="GDP per capita between 0 and 10000 represented by 0, between 10000 and 20000 by a 10 etc")
ggplot(small)+geom_jitter(aes(`Highways(km)`,`Railways(km)`,color=as.factor(GDP_fac)))+
  facet_wrap(~area_fac)+
  geom_smooth(method=lm,aes(`Highways(km)`,`Railways(km)`),se=F)+#coord_cartesian(xlim=c(0,3962.8))+
  labs(title='Highways and Railroad in Small countries',color="Categorical GDP per capita in Thousands",
       caption="GDP per capita between 0 and 10000 represented by 0, between 10000 and 20000 by a 10 etc")
```




```{r}
bfactbook<-bfactbook%>%mutate("oil_percapita"=`Oil - consumption(bbl/day)`/Population)
ggplot(bfactbook,aes(ratio,oil_percapita))+geom_point()+geom_smooth(se=F,method=lm)+coord_cartesian(xlim=c(0,.2))+
labs(title="Oil Consumption vs. Ratio of Railways to Highways",x="Ratio of Railroad to Highways",y="Per Capita Oil Consumed (bbl/day)")  
bfb<-bfactbook%>%filter(!is.na(ratio)&!is.na(`oil_percapita`))
```



Correlation Between Ratio of Railways to Highways and Oil consumption in bbl/day

```{r}
cor(bfb$ratio,bfb$oil_percapita)
```



### Findings: 
From the graph directly above, and the correlation coefficient, there is no significant correlation between the ratio of railroads to higways. This could mean a variety of things, such as the effeciency of trains and highways not being significantly different, or usage rates varying not being reflected by size of the rail network. Either way this means it is not particularly useful to build more railways per km of highway in reducing oil use. From the first two graphs (again the third is for small countries and other territories, and in fact most of the countries have NAs across most of their variables), it can be seen that across GDP and country size there is a positive correlation between kilometers of highways in a country and kilometers of railways in a country. This makes sense, as both are correlated to country size. The slope of the lines varies between the GDP levels, but there doesn't seem to be any consistant trends about what level of wealth leads to higher or lower slopes of the linear model. 
























