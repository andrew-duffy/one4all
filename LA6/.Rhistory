((nrow(filter(DENflights,CARRIER=="WN"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="EV"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="F9"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="NK"&late))/nrow(DENflights))/
p_late)
))
arrange(late_by_carrier,prob)
late_by_carrier<-data.frame("Carrier","Probability")
late_by_carrier<-data.frame("carrier"=c("AA","AS","B6","DL","OO","UA","VX","WN","EV","F9","NK"),
"prob"=c(
((nrow(filter(DENflights,CARRIER=="AA"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="AS"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="B6"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="DL"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="OO"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="UA"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="VX"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="WN"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="EV"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="F9"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="NK"&late))/nrow(DENflights))/
p_late)
))
arrange(desc(late_by_carrier,prob))
late_by_carrier<-data.frame("Carrier","Probability")
late_by_carrier<-data.frame("carrier"=c("AA","AS","B6","DL","OO","UA","VX","WN","EV","F9","NK"),
"prob"=c(
((nrow(filter(DENflights,CARRIER=="AA"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="AS"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="B6"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="DL"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="OO"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="UA"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="VX"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="WN"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="EV"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="F9"&late))/nrow(DENflights))/
p_late),
((nrow(filter(DENflights,CARRIER=="NK"&late))/nrow(DENflights))/
p_late)
))
arrange(late_by_carrier,desc(prob))
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
mont_prob
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
month_prob
DENflights<-DENflights%>%mutate(late= ARR_DELAY>=15)
DENflights_arrived<-DENflights%>%filter(!is.na(ARR_TIME))
DENflights_arrived_late<-DENflights_arrived%>%filter(!is.na(late))
delayed_flights<-DENflights%>%filter(DEP_DELAY>=15)
DENflights_arrived_late<-DENflights_arrived_late%>%
mutate(sched_dep_hour=as.numeric(CRS_DEP_TIME%/%100))%>%
mutate(sched_arr_time=as.numeric(CRS_ARR_TIME%/%100))%>%
mutate(act_arr_hour=as.numeric(ARR_TIME%/%100))%>%
mutate(act_dep_hour=as.numeric(DEP_TIME%/%100))
DENflights<-DENflights%>%mutate(late= ARR_DELAY>=15)
DENflights_arrived<-DENflights%>%filter(!is.na(ARR_TIME))
DENflights_arrived_late<-DENflights_arrived%>%filter(!is.na(late))
delayed_flights<-DENflights%>%filter(DEP_DELAY>=15)
DENflights_arrived_late<-DENflights_arrived_late%>%
mutate(sched_dep_hour=as.numeric(CRS_DEP_TIME)%/%100)%>%
mutate(sched_arr_time=as.numeric(CRS_ARR_TIME)%/%100)%>%
mutate(act_arr_hour=as.numeric(ARR_TIME)%/%100)%>%
mutate(act_dep_hour=as.numeric(DEP_TIME)%/%100)
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
day_prob<-DENflights_arrived_late%>%group_by(DAY_OF_MONTH)%>%summarize(prob=mean(late))
carrier_prob<-DENflights_arrived_late%>%group_by(CARRIER)%>%summarize(prob=mean(late))
origin_prob<-DENflights_arrived_late%>%group_by(ORIGIN)%>%summarize(prob=mean(late))
dest_prob<-DENflights_arrived_late%>%group_by(DEST)%>%summarize(prob=mean(late))
sched_arr_prob<-DENflights_arrived_late%>%group_by(sched_arr_time)%>%summarize(prob=mean(late))
arr_prob<-DENflights_arrived_late%>%group_by(act_arr_hour)%>%summarize(prob=mean(late))
sched_dep_prob<-DENflights_arrived_late%>%group_by(sched_dep_hour)%>%summarize(prob=mean(late))
dep_prob<-DENflights_arrived_late%>%group_by(act_dep_hour)%>%summarize(prob=mean(late))
dep_del_prob<-DENflights_arrived_late%>%group_by(DEP_DELAY)%>%summarize(prob=mean(late))
taxi_in_prob<-DENflights_arrived_late%>%group_by(TAXI_IN)%>%summarize(prob=mean(late))
taxi_out_prob<-DENflights_arrived_late%>%group_by(TAXI_OUT)%>%summarize(prob=mean(late))
flight_time_prob<-DENflights_arrived_late%>%group_by(AIR_TIME)%>%summarize(prob=mean(late))
actual_flight_time_prob<-DENflights_arrived_late%>%group_by(ACTUAL_ELAPSED_TIME)%>%summarize(prob=mean(late))
distance_prob<-DENflights_arrived_late%>%group_by(DISTANCE)%>%summarize(prob=mean(late))
carrier_del_prob<-DENflights_arrived_late%>%group_by(CARRIER_DELAY)%>%summarize(prob=mean(late))
security_del_prob<-DENflights_arrived_late%>%group_by(SECURITY_DELAY)%>%summarize(prob=mean(late))
nas_del_prob<-DENflights_arrived_late%>%group_by(NAS_DELAY)%>%summarize(prob=mean(late))
weather_del_prob<-DENflights_arrived_late%>%group_by(WEATHER_DELAY)%>%summarize(prob=mean(late))
plane_del_prob<-DENflights_arrived_late%>%group_by(LATE_AIRCRAFT_DELAY)%>%summarize(prob=mean(late))
var_prob<-data.frame("Variable"=c('month_prob','day_prob','carrier_prob','origin_prob',
'dest_prob','sched_arr_prob','arr_prob','sched_dep_prob','dep_prob',
'dep_del_prob','taxi_in_prob','taxi_out_prob',
'flight_time_prob','actual_flight_time_prob','distance_prob',
'carrier_del_prob','security_del_prob','nas_del_prob',
'weather_del_prob','plane_del_prob'),
"Variation"=c(sd(month_prob$prob),sd(day_prob$prob),sd(carrier_prob$prob),sd(origin_prob$prob),
sd(dest_prob$prob),sd(sched_arr_prob$prob),sd(arr_prob$prob),
sd(sched_dep_prob$prob),sd(dep_prob$prob),sd(dep_del_prob$prob),
sd(taxi_in_prob$prob),sd(taxi_out_prob$prob),sd(flight_time_prob$prob),
sd(actual_flight_time_prob$prob),sd(distance_prob$prob),sd(carrier_del_prob$prob),
sd(security_del_prob$prob),sd(nas_del_prob$prob),sd(weather_del_prob$prob),
sd(plane_del_prob$prob)
)
var_prob
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
day_prob<-DENflights_arrived_late%>%group_by(DAY_OF_MONTH)%>%summarize(prob=mean(late))
carrier_prob<-DENflights_arrived_late%>%group_by(CARRIER)%>%summarize(prob=mean(late))
origin_prob<-DENflights_arrived_late%>%group_by(ORIGIN)%>%summarize(prob=mean(late))
dest_prob<-DENflights_arrived_late%>%group_by(DEST)%>%summarize(prob=mean(late))
sched_arr_prob<-DENflights_arrived_late%>%group_by(sched_arr_time)%>%summarize(prob=mean(late))
arr_prob<-DENflights_arrived_late%>%group_by(act_arr_hour)%>%summarize(prob=mean(late))
sched_dep_prob<-DENflights_arrived_late%>%group_by(sched_dep_hour)%>%summarize(prob=mean(late))
dep_prob<-DENflights_arrived_late%>%group_by(act_dep_hour)%>%summarize(prob=mean(late))
dep_del_prob<-DENflights_arrived_late%>%group_by(DEP_DELAY)%>%summarize(prob=mean(late))
taxi_in_prob<-DENflights_arrived_late%>%group_by(TAXI_IN)%>%summarize(prob=mean(late))
taxi_out_prob<-DENflights_arrived_late%>%group_by(TAXI_OUT)%>%summarize(prob=mean(late))
flight_time_prob<-DENflights_arrived_late%>%group_by(AIR_TIME)%>%summarize(prob=mean(late))
actual_flight_time_prob<-DENflights_arrived_late%>%group_by(ACTUAL_ELAPSED_TIME)%>%summarize(prob=mean(late))
distance_prob<-DENflights_arrived_late%>%group_by(DISTANCE)%>%summarize(prob=mean(late))
carrier_del_prob<-DENflights_arrived_late%>%group_by(CARRIER_DELAY)%>%summarize(prob=mean(late))
security_del_prob<-DENflights_arrived_late%>%group_by(SECURITY_DELAY)%>%summarize(prob=mean(late))
nas_del_prob<-DENflights_arrived_late%>%group_by(NAS_DELAY)%>%summarize(prob=mean(late))
weather_del_prob<-DENflights_arrived_late%>%group_by(WEATHER_DELAY)%>%summarize(prob=mean(late))
plane_del_prob<-DENflights_arrived_late%>%group_by(LATE_AIRCRAFT_DELAY)%>%summarize(prob=mean(late))
var_prob<-data.frame("Variable"=c('month_prob','day_prob','carrier_prob','origin_prob',
'dest_prob','sched_arr_prob','arr_prob','sched_dep_prob','dep_prob',
'dep_del_prob','taxi_in_prob','taxi_out_prob',
'flight_time_prob','actual_flight_time_prob','distance_prob',
'carrier_del_prob','security_del_prob','nas_del_prob',
'weather_del_prob','plane_del_prob'),
"Variation"=c(sd(month_prob$prob),sd(day_prob$prob),sd(carrier_prob$prob),sd(origin_prob$prob),
sd(dest_prob$prob),sd(sched_arr_prob$prob),sd(arr_prob$prob),
sd(sched_dep_prob$prob),sd(dep_prob$prob),sd(dep_del_prob$prob),
sd(taxi_in_prob$prob),sd(taxi_out_prob$prob),sd(flight_time_prob$prob),
sd(actual_flight_time_prob$prob),sd(distance_prob$prob),sd(carrier_del_prob$prob),
sd(security_del_prob$prob),sd(nas_del_prob$prob),sd(weather_del_prob$prob),
sd(plane_del_prob$prob)
)
)
var_prob
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
day_prob<-DENflights_arrived_late%>%group_by(DAY_OF_MONTH)%>%summarize(prob=mean(late))
carrier_prob<-DENflights_arrived_late%>%group_by(CARRIER)%>%summarize(prob=mean(late))
origin_prob<-DENflights_arrived_late%>%group_by(ORIGIN)%>%summarize(prob=mean(late))
dest_prob<-DENflights_arrived_late%>%group_by(DEST)%>%summarize(prob=mean(late))
sched_arr_prob<-DENflights_arrived_late%>%group_by(sched_arr_time)%>%summarize(prob=mean(late))
arr_prob<-DENflights_arrived_late%>%group_by(act_arr_hour)%>%summarize(prob=mean(late))
sched_dep_prob<-DENflights_arrived_late%>%group_by(sched_dep_hour)%>%summarize(prob=mean(late))
dep_prob<-DENflights_arrived_late%>%group_by(act_dep_hour)%>%summarize(prob=mean(late))
dep_del_prob<-DENflights_arrived_late%>%group_by(DEP_DELAY)%>%summarize(prob=mean(late))
taxi_in_prob<-DENflights_arrived_late%>%group_by(TAXI_IN)%>%summarize(prob=mean(late))
taxi_out_prob<-DENflights_arrived_late%>%group_by(TAXI_OUT)%>%summarize(prob=mean(late))
flight_time_prob<-DENflights_arrived_late%>%group_by(AIR_TIME)%>%summarize(prob=mean(late))
actual_flight_time_prob<-DENflights_arrived_late%>%group_by(ACTUAL_ELAPSED_TIME)%>%summarize(prob=mean(late))
distance_prob<-DENflights_arrived_late%>%group_by(DISTANCE)%>%summarize(prob=mean(late))
carrier_del_prob<-DENflights_arrived_late%>%group_by(CARRIER_DELAY)%>%summarize(prob=mean(late))
security_del_prob<-DENflights_arrived_late%>%group_by(SECURITY_DELAY)%>%summarize(prob=mean(late))
nas_del_prob<-DENflights_arrived_late%>%group_by(NAS_DELAY)%>%summarize(prob=mean(late))
weather_del_prob<-DENflights_arrived_late%>%group_by(WEATHER_DELAY)%>%summarize(prob=mean(late))
plane_del_prob<-DENflights_arrived_late%>%group_by(LATE_AIRCRAFT_DELAY)%>%summarize(prob=mean(late))
var_prob<-data.frame("Variable"=c('month_prob','day_prob','carrier_prob','origin_prob',
'dest_prob','sched_arr_prob','arr_prob','sched_dep_prob','dep_prob',
'dep_del_prob','taxi_in_prob','taxi_out_prob',
'flight_time_prob','actual_flight_time_prob','distance_prob',
'carrier_del_prob','security_del_prob','nas_del_prob',
'weather_del_prob','plane_del_prob'),
"Variation"=c(sd(month_prob$prob),sd(day_prob$prob),sd(carrier_prob$prob),sd(origin_prob$prob),
sd(dest_prob$prob),sd(sched_arr_prob$prob),sd(arr_prob$prob),
sd(sched_dep_prob$prob),sd(dep_prob$prob),sd(dep_del_prob$prob),
sd(taxi_in_prob$prob),sd(taxi_out_prob$prob),sd(flight_time_prob$prob),
sd(actual_flight_time_prob$prob),sd(distance_prob$prob),sd(carrier_del_prob$prob),
sd(security_del_prob$prob),sd(nas_del_prob$prob),sd(weather_del_prob$prob),
sd(plane_del_prob$prob)
)
)
arrange(var_prob,desc(Variation))
arrange(var_prob,desc(Variation))
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
day_prob<-DENflights_arrived_late%>%group_by(DAY_OF_MONTH)%>%summarize(prob=mean(late))
carrier_prob<-DENflights_arrived_late%>%group_by(CARRIER)%>%summarize(prob=mean(late))
origin_prob<-DENflights_arrived_late%>%group_by(ORIGIN)%>%summarize(prob=mean(late))
dest_prob<-DENflights_arrived_late%>%group_by(DEST)%>%summarize(prob=mean(late))
sched_arr_prob<-DENflights_arrived_late%>%group_by(sched_arr_time)%>%summarize(prob=mean(late))
arr_prob<-DENflights_arrived_late%>%group_by(act_arr_hour)%>%summarize(prob=mean(late))
sched_dep_prob<-DENflights_arrived_late%>%group_by(sched_dep_hour)%>%summarize(prob=mean(late))
dep_prob<-DENflights_arrived_late%>%group_by(act_dep_hour)%>%summarize(prob=mean(late))
dep_del_prob<-DENflights_arrived_late%>%group_by(DEP_DELAY)%>%summarize(prob=mean(late))
taxi_in_prob<-DENflights_arrived_late%>%group_by(TAXI_IN)%>%summarize(prob=mean(late))
taxi_out_prob<-DENflights_arrived_late%>%group_by(TAXI_OUT)%>%summarize(prob=mean(late))
flight_time_prob<-DENflights_arrived_late%>%group_by(AIR_TIME)%>%summarize(prob=mean(late))
actual_flight_time_prob<-DENflights_arrived_late%>%group_by(ACTUAL_ELAPSED_TIME)%>%summarize(prob=mean(late))
distance_prob<-DENflights_arrived_late%>%group_by(DISTANCE)%>%summarize(prob=mean(late))
carrier_del_prob<-DENflights_arrived_late%>%group_by(CARRIER_DELAY)%>%summarize(prob=mean(late))
security_del_prob<-DENflights_arrived_late%>%group_by(SECURITY_DELAY)%>%summarize(prob=mean(late))
nas_del_prob<-DENflights_arrived_late%>%group_by(NAS_DELAY)%>%summarize(prob=mean(late))
weather_del_prob<-DENflights_arrived_late%>%group_by(WEATHER_DELAY)%>%summarize(prob=mean(late))
plane_del_prob<-DENflights_arrived_late%>%group_by(LATE_AIRCRAFT_DELAY)%>%summarize(prob=mean(late))
var_prob<-data.frame("Variable"=c('month','day','carrier','origin',
'destination','scheduled arrival','Actual arrival Time',
'scheduled departure timme','Actual departure time',
'Departure Delay','Taxi in time','Taxi out time',
'Scheduled Flight Time','Actual Flight Time','Distance',
'carrier delay','security delay','nas delay',
'weather delay','Aircraft Arrival Delay'),
"Variation"=c(sd(month_prob$prob),sd(day_prob$prob),sd(carrier_prob$prob),sd(origin_prob$prob),
sd(dest_prob$prob),sd(sched_arr_prob$prob),sd(arr_prob$prob),
sd(sched_dep_prob$prob),sd(dep_prob$prob),sd(dep_del_prob$prob),
sd(taxi_in_prob$prob),sd(taxi_out_prob$prob),sd(flight_time_prob$prob),
sd(actual_flight_time_prob$prob),sd(distance_prob$prob),sd(carrier_del_prob$prob),
sd(security_del_prob$prob),sd(nas_del_prob$prob),sd(weather_del_prob$prob),
sd(plane_del_prob$prob)
)
)
arrange(var_prob,desc(Variation))
taxi_in_prob
ggplot(data=taxi_in_prob,aes(TAXI_IN,prob))+geom_point()
ggplot(data=taxi_in_prob,aes(TAXI_IN,prob))+geom_point()+
labs(title="Taxi in Time and Probability of a late flight",
x="Taxi in time in minutes",
y='Probability')
ggplot(data=taxi_in_prob,aes(TAXI_OUT,prob))+geom_point()+
labs(title="Taxi out Time and Probability of a late flight",
x="Taxi out time in minutes",
y='Probability')
ggplot(data=taxi_out_prob,aes(TAXI_OUT,prob))+geom_point()+
labs(title="Taxi out Time and Probability of a late flight",
x="Taxi out time in minutes",
y='Probability')
ggplot(data=dep_prob,aes(act_dep_hour,prob))+geom_point()+
labs(title="Taxi in Time and Probability of a late flight",
x="Taxi in time in minutes",
y='Probability')
ggplot(data=dep_prob,aes(act_dep_hour,prob))+geom_smooth()+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=dep_prob,aes(act_dep_hour,prob))+geom_smooth(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
dep_del_prob
ggplot(data=dep_del_prob,aes(dep_del,prob))+geom_smooth(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=dep_del_prob,aes(DEP_DELAY,prob))+geom_smooth(se=F)+
labs(title="Departure Delay and Probability of a late flight",
x="Departure Delay in minutes",
y='Probability')
ggplot(data=dep_del_prob,aes(DEP_DELAY,prob))+geom_point(se=F)+
labs(title="Departure Delay and Probability of a late flight",
x="Departure Delay in minutes",
y='Probability')
ggplot(data=dep_del_prob,aes(DEP_DELAY,prob))+geom_smooth(se=F)+
labs(title="Departure Delay and Probability of a late flight",
x="Departure Delay in minutes",
y='Probability',caption="Probabilities in excess of 1 are an artefact of the smoothing")
actual_flight_time_prob
ggplot(data=_prob,aes(act_dep_hour,prob))+geom_smooth(se=F)+
actual_flight_time_prob
ggplot(data=actual_flight_time_prob,aes(ACTUAL_ELAPSED_TIME,prob))+geom_smooth(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=actual_flight_time_prob,aes(ACTUAL_ELAPSED_TIME,prob))+geom_point(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=actual_flight_time_prob,aes(ACTUAL_ELAPSED_TIME,prob))+geom_smooth(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=actual_flight_time_prob,aes(ACTUAL_ELAPSED_TIME,prob))+geom_smooth(se=F)+
labs(title="Flight Time and Probability of a late flight",
x="Flight Time in Minutes",
y='Probability')
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
correlations
cor2
cor2%>%arrange(desc(value))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value))
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value))
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value))+
labs(title="Correlations Between Total Delay and Various Delay Types",
x="Delay Type",y="Correlation between Total Delay and Delay Type")
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value),color="blue")+
labs(title="Correlations Between Total Delay and Various Delay Types",
x="Delay Type",y="Correlation between Total Delay and Delay Type")
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value),fill="blue")+
labs(title="Correlations Between Total Delay and Various Delay Types",
x="Delay Type",y="Correlation between Total Delay and Delay Type")
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plateNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
COflights <- read_csv("https://files.osf.io/v1/resources/3z5as4pej8/providers/osfstorage/5a8ca28f57103100104584db")
DENflights <- COflights %>% filter(ORIGIN=="DEN" | DEST =="DEN")
DENflights<-DENflights%>%mutate(late= ARR_DELAY>=15)
DENflights_arrived<-DENflights%>%filter(!is.na(ARR_TIME))
DENflights_arrived_late<-DENflights_arrived%>%filter(!is.na(late))
delayed_flights<-DENflights%>%filter(DEP_DELAY>=15)
DENflights_arrived_late<-DENflights_arrived_late%>%
mutate(sched_dep_hour=as.numeric(CRS_DEP_TIME)%/%100)%>%
mutate(sched_arr_time=as.numeric(CRS_ARR_TIME)%/%100)%>%
mutate(act_arr_hour=as.numeric(ARR_TIME)%/%100)%>%
mutate(act_dep_hour=as.numeric(DEP_TIME)%/%100)
month_prob<-DENflights_arrived_late%>%group_by(MONTH)%>%summarize(prob=mean(late))
day_prob<-DENflights_arrived_late%>%group_by(DAY_OF_MONTH)%>%summarize(prob=mean(late))
carrier_prob<-DENflights_arrived_late%>%group_by(CARRIER)%>%summarize(prob=mean(late))
origin_prob<-DENflights_arrived_late%>%group_by(ORIGIN)%>%summarize(prob=mean(late))
dest_prob<-DENflights_arrived_late%>%group_by(DEST)%>%summarize(prob=mean(late))
sched_arr_prob<-DENflights_arrived_late%>%group_by(sched_arr_time)%>%summarize(prob=mean(late))
arr_prob<-DENflights_arrived_late%>%group_by(act_arr_hour)%>%summarize(prob=mean(late))
sched_dep_prob<-DENflights_arrived_late%>%group_by(sched_dep_hour)%>%summarize(prob=mean(late))
dep_prob<-DENflights_arrived_late%>%group_by(act_dep_hour)%>%summarize(prob=mean(late))
dep_del_prob<-DENflights_arrived_late%>%group_by(DEP_DELAY)%>%summarize(prob=mean(late))
taxi_in_prob<-DENflights_arrived_late%>%group_by(TAXI_IN)%>%summarize(prob=mean(late))
taxi_out_prob<-DENflights_arrived_late%>%group_by(TAXI_OUT)%>%summarize(prob=mean(late))
flight_time_prob<-DENflights_arrived_late%>%group_by(AIR_TIME)%>%summarize(prob=mean(late))
actual_flight_time_prob<-DENflights_arrived_late%>%group_by(ACTUAL_ELAPSED_TIME)%>%summarize(prob=mean(late))
distance_prob<-DENflights_arrived_late%>%group_by(DISTANCE)%>%summarize(prob=mean(late))
carrier_del_prob<-DENflights_arrived_late%>%group_by(CARRIER_DELAY)%>%summarize(prob=mean(late))
security_del_prob<-DENflights_arrived_late%>%group_by(SECURITY_DELAY)%>%summarize(prob=mean(late))
nas_del_prob<-DENflights_arrived_late%>%group_by(NAS_DELAY)%>%summarize(prob=mean(late))
weather_del_prob<-DENflights_arrived_late%>%group_by(WEATHER_DELAY)%>%summarize(prob=mean(late))
plane_del_prob<-DENflights_arrived_late%>%group_by(LATE_AIRCRAFT_DELAY)%>%summarize(prob=mean(late))
var_prob<-data.frame("Variable"=c('month','day','carrier','origin',
'destination','scheduled arrival','Actual arrival Time',
'scheduled departure timme','Actual departure time',
'Departure Delay','Taxi in time','Taxi out time',
'Scheduled Flight Time','Actual Flight Time','Distance',
'carrier delay','security delay','nas delay',
'weather delay','Aircraft Arrival Delay'),
"Variation"=c(sd(month_prob$prob),sd(day_prob$prob),sd(carrier_prob$prob),sd(origin_prob$prob),
sd(dest_prob$prob),sd(sched_arr_prob$prob),sd(arr_prob$prob),
sd(sched_dep_prob$prob),sd(dep_prob$prob),sd(dep_del_prob$prob),
sd(taxi_in_prob$prob),sd(taxi_out_prob$prob),sd(flight_time_prob$prob),
sd(actual_flight_time_prob$prob),sd(distance_prob$prob),sd(carrier_del_prob$prob),
sd(security_del_prob$prob),sd(nas_del_prob$prob),sd(weather_del_prob$prob),
sd(plane_del_prob$prob)
)
)
arrange(var_prob,desc(Variation))
ggplot(data=taxi_in_prob,aes(TAXI_IN,prob))+geom_point()+
labs(title="Taxi in Time and Probability of a late flight",
x="Taxi in time in minutes",
y='Probability')
ggplot(data=taxi_out_prob,aes(TAXI_OUT,prob))+geom_point()+
labs(title="Taxi out Time and Probability of a late flight",
x="Taxi out time in minutes",
y='Probability')
ggplot(data=dep_prob,aes(act_dep_hour,prob))+geom_smooth(se=F)+
labs(title="Departure time and Probability of a late flight",
x="Departure time hour (24 hrs)",
y='Probability')
ggplot(data=dep_del_prob,aes(DEP_DELAY,prob))+geom_smooth(se=F)+
labs(title="Departure Delay and Probability of a late flight",
x="Departure Delay in minutes",
y='Probability',caption="Probabilities in excess of 1 are an artefact of the smoothing")
ggplot(data=actual_flight_time_prob,aes(ACTUAL_ELAPSED_TIME,prob))+geom_smooth(se=F)+
labs(title="Flight Time and Probability of a late flight",
x="Flight Time in Minutes",
y='Probability')
p_late<-mean(DENflights_arrived_late$late)
p_late
useful_data_NAS<-COflights%>%filter(!is.na(NAS_DELAY)&!is.na(DEP_DELAY))
corNAS<-cor(useful_data_NAS$DEP_DELAY,useful_data_NAS$NAS_DELAY)
useful_data_WEATHER<-COflights%>%filter(!is.na(WEATHER_DELAY)&!is.na(DEP_DELAY))
corWEATHER<-cor(useful_data_WEATHER$DEP_DELAY,useful_data_WEATHER$WEATHER_DELAY)
useful_data_SECURITY<-COflights%>%filter(!is.na(SECURITY_DELAY)&!is.na(DEP_DELAY))
corSECURITY<-cor(useful_data_SECURITY$DEP_DELAY,useful_data_SECURITY$SECURITY_DELAY)
useful_data_CARRIER<-COflights%>%filter(!is.na(CARRIER_DELAY)&!is.na(DEP_DELAY))
corCARRIER<-cor(useful_data_CARRIER$DEP_DELAY,useful_data_CARRIER$CARRIER_DELAY)
correlations<-data.frame(security=c(corSECURITY),carrier=c(corCARRIER),nas=c(corNAS), weather=c(corWEATHER))
cor2<-data.frame(name=c("security","carrier","NAS","weather"),value=c(corSECURITY,corCARRIER,corNAS,corWEATHER))
ggplot(data=cor2)+geom_col(aes(x=reorder(name,value),y=value),fill="blue")+
labs(title="Correlations Between Total Delay and Various Delay Types",
x="Delay Type",y="Correlation between Total Delay and Delay Type")
nas_delayed<-COflights%>%filter(NAS_DELAY>0&DEP_DELAY>=15)
NAS_del<-nrow(nas_delayed)/nrow(delayed_flights)
WEATHER_delayed<-COflights%>%filter(WEATHER_DELAY>0&DEP_DELAY>=15)
weather_del<-nrow(WEATHER_delayed)/nrow(delayed_flights)
carrier_delayed<-COflights%>%filter(CARRIER_DELAY>0&DEP_DELAY>=15)
carrier_del<-nrow(carrier_delayed)/nrow(delayed_flights)
security_delayed<-COflights%>%filter(SECURITY_DELAY>0&DEP_DELAY>=15)
security_del<-nrow(security_delayed)/nrow(delayed_flights)
DELAY_SECURITY<-COflights%>%filter(SECURITY_DELAY>0)
late_security<-DELAY_SECURITY%>%filter(DEP_DELAY>=15)
(plategSECURITY<-nrow(late_security)/nrow(DELAY_SECURITY))
DELAY_CARRIER<-COflights%>%filter(CARRIER_DELAY>0)
late_carrier<-DELAY_CARRIER%>%filter(DEP_DELAY>=15)
(plategCARRIER<-nrow(late_carrier)/nrow(DELAY_CARRIER))
DELAY_WEATHER<-COflights%>%filter(WEATHER_DELAY>0)
late_weather<-DELAY_WEATHER%>%filter(DEP_DELAY>=15)
(plategWEATHER<-nrow(late_weather)/nrow(DELAY_WEATHER))
DELAY_NAS<-COflights%>%filter(NAS_DELAY>0)
late_NAS<-DELAY_NAS%>%filter(DEP_DELAY>=15)
(plategNAS<-nrow(late_NAS)/nrow(DELAY_NAS))
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plateNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plategNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
prob_delay
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plategNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
ggplot(data=prob_delay,aes(Delay_Type,Probability_Given_Late))+geomM_col(fill="red")
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plategNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
ggplot(data=prob_delay,aes(Delay_Type,Probability_Given_Late))+geom_col(fill="red")
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plategNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
ggplot(data=prob_delay,aes(reorder(Delay_Type,Probability_Given_Late),
Probability_Given_Late))+geom_col(fill="red")
prob_delay<-data.frame("Delay_Type"=c("NAS","Security","Weather","Carrier"),
"Probability_Given_Late"=c(NAS_del,security_del,weather_del,carrier_del),
"Probability_late_Given"=c(plategNAS,plategSECURITY,plategWEATHER,
plategCARRIER)
)
ggplot(data=prob_delay,aes(reorder(Delay_Type,Probability_Given_Late),
Probability_Given_Late))+geom_col(fill="red")+
labs(title="Probability Delay is Caused By Delay Type",
x="Type of Delay",
y="Probability Delay Type COntributed to Late Arrival")
ggplot(data=prob_delay,aes(reorder(Delay_Type,Probability_late_Given),
Probability_late_Given))+geom_col(fill="purple")+
labs(title="Probability you are Delayed if Delayed by Delay Type",
x="Type of Delay",
y="Probability Late Given Delay Type")
