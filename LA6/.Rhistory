knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
COflights <- read_csv("https://files.osf.io/v1/resources/3z5as4pej8/providers/osfstorage/5a8ca28f57103100104584db")
airport_size<-COflights%>%group_by(ORIGIN)%>%summarize(size=n(),sec_del=mean(SECURITY_DELAY),
nas_del=mean(NAS_DELAY),
wthr_del=mean(WEATHER_DELAY),
car_del=mean(CARRIER_DELAY))%>%
rename(airport=ORIGIN)
airport_size
airport_size<-COflights%>%group_by(ORIGIN)%>%summarize(size=n(),sec_del=mean(SECURITY_DELAY,
na.rm=T),
nas_del=mean(NAS_DELAY,
na.rm=T),
wthr_del=mean(WEATHER_DELAY,
na.rm=T),
car_del=mean(CARRIER_DELAY,
na.rm=T))%>%
rename(airport=ORIGIN)
airport_size
airport_size<-COflights%>%group_by(ORIGIN)%>%summarize(size=n(), tot_del=mean(DEP_DELAY,
na.rm=T)
sec_del=mean(SECURITY_DELAY,
airport_size<-COflights%>%group_by(ORIGIN)%>%summarize(size=n(), tot_del=mean(DEP_DELAY,
na.rm=T),
sec_del=mean(SECURITY_DELAY,
na.rm=T),
nas_del=mean(NAS_DELAY,
na.rm=T),
wthr_del=mean(WEATHER_DELAY,
na.rm=T),
car_del=mean(CARRIER_DELAY,
na.rm=T))%>%
rename(airport=ORIGIN)
airport_size
ggplot(data=airport_size,aes(x=size))+
geom_point(aes(y=tot_del),color="darkred")+
geom_point(aes(y=sec_del),color="blue1")+
geom_point(aes(y=nas_del),color="plum4")+
geom_point(aes(y=wthr_del),color=614)+
geom_point(aes(y=car_del),color="aquamarine")
ggplot(data=airport_size,aes(x=size))+
geom_point(aes(y=tot_del),color="darkred")+
geom_point(aes(y=sec_del),color="blue1")+
geom_point(aes(y=nas_del),color="plum4")+
geom_point(aes(y=wthr_del),color=614)+
geom_point(aes(y=car_del),color="aquamarine")+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred")+
geom_smooth(aes(y=sec_del),color="blue1")+
geom_smooth(aes(y=nas_del),color="plum4")+
geom_smooth(aes(y=wthr_del),color=614)+
geom_smooth(aes(y=car_del),color="aquamarine")+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_density()
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred")+
geom_smooth(aes(y=sec_del),color="blue1")+
geom_smooth(aes(y=nas_del),color="plum4")+
geom_smooth(aes(y=wthr_del),color=614)+
geom_smooth(aes(y=car_del),color="aquamarine")+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm)+
geom_smooth(aes(y=wthr_del),color=614,method=lm)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm)+
geom_smooth(aes(y=wthr_del),color=614,method=lm)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
unique(airport_size)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
unique(airport_size%size)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
unique(airport_size$size)
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
order(unique(airport_size$size))
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
sort(unique(airport_size$size))
ggplot(data=airport_size,aes(x=size))+
geom_smooth(aes(y=tot_del),color="darkred",method=lm,se=F)+
geom_smooth(aes(y=sec_del),color="blue1",method=lm,se=F)+
geom_smooth(aes(y=nas_del),color="plum4",method=lm,se=F)+
geom_smooth(aes(y=wthr_del),color=614,method=lm,se=F)+
geom_smooth(aes(y=car_del),color="aquamarine",method=lm,se=F)+
xlim(0,25000)
ggplot(data=airport_size,aes(size))+geom_bar()+xlim(0,15000)
sort(unique(airport_size$size))
airport_size%>%filter(size>15000)
airport_size<-airport_size%>%filter(airport!="DEN")
airport_size%>%arrange(desc(size))
airport_size<-airport_size%>%filter(airport!="DEN")
airport_size%>%arrange(desc(size))
median(airport_size$size)
airport_size<-airport_size%>%filter(airport!="DEN")
airport_size%>%arrange(desc(size))
mean(airport_size$size)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del))
delay_by_size
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="gray",alpha=0.5)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="orange",alpha=0.7)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="orange",alpha=0.7)+
labs(color="Delay Type")
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="lightblue",alpha=0.7)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="lightblue",alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="lightblue",alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
small_airports<-airport_size%>%filter(small=T)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del),color="blue",alpha=0.3)+
geom_col(aes(small,nas_del),color="red",alpha=0.3)+
geom_col(aes(small,car_del),color="purple",alpha=0.3)+
geom_col(aes(small,wthr_del),color="pink",alpha=0.3)+
geom_col(aes(small,tot_del),fill="lightblue",alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
small_airports<-airport_size%>%filter(small==T)
large_airports<-airport_size%>%filter(small==F)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del,color="Security Delay"),alpha=0.3)+
geom_col(aes(small,nas_del,color="NAS Delay"),alpha=0.3)+
geom_col(aes(small,car_del,color="Carrier Delay"),alpha=0.3)+
geom_col(aes(small,wthr_del,color="Weather Delay"),alpha=0.3)+
geom_col(aes(small,tot_del,fill="Total Delay"),alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')+
small_airports<-airport_size%>%filter(small==T)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del,color="Security Delay"),alpha=0.3)+
geom_col(aes(small,nas_del,color="NAS Delay"),alpha=0.3)+
geom_col(aes(small,car_del,color="Carrier Delay"),alpha=0.3)+
geom_col(aes(small,wthr_del,color="Weather Delay"),alpha=0.3)+
geom_col(aes(small,tot_del,fill="Total Delay"),alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
small_airports<-airport_size%>%filter(small==T)
large_airports<-airport_size%>%filter(small==F)
airport_size<-airport_size%>%
mutate(small= size<1000)
delay_by_size<-airport_size%>%
group_by(small)%>%
summarize(num=n(),
sec_del=mean(sec_del),
nas_del=mean(nas_del),
wthr_del=mean(wthr_del),
car_del=mean(car_del),
tot_del=mean(tot_del))
delay_by_size
ggplot(data=delay_by_size)+geom_col(aes(small,sec_del,color="Security Delay"),alpha=0.3)+
geom_col(aes(small,nas_del,color="NAS Delay"),alpha=0.3)+
geom_col(aes(small,car_del,color="Carrier Delay"),alpha=0.3)+
geom_col(aes(small,wthr_del,color="Weather Delay"),alpha=0.3)+
geom_col(aes(small,tot_del,color="Total Delay"),alpha=0.3)+
labs(title="Airport Size and Delay Type",x="Is the Airport Small",
y='Delay in Minutes')
small_airports<-airport_size%>%filter(small==T)
large_airports<-airport_size%>%filter(small==F)
