---
title: "One4All_LA8"
author: "Braden Griebel, Luke Fanning, Andrew Duffy, Ahyo Falick"
date: "10/16/2019"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

# Team Question: 


dataset:

```{r}
factbook<-read_delim("factbook.csv",delim=";",col_types = cols(
  Country=col_character(),
  `Area(sq km)`=col_double(),
  `Birth rate(births/1000 population)`=col_double(),
  `Current account balance`=col_double(),
  `Death rate(deaths/1000 population)`=col_double(),
  `Debt - external`=col_double(),
  `Electricity - consumption(kWh)`=col_double(),
  `Electricity - production(kWh)`=col_double(),
  `Exports`=col_double(),
  `GDP`=col_double(),
  `GDP - per capita`=col_double(),
  `GDP - real growth rate(%)`=col_double(),
  `HIV/AIDS - adult prevalence rate(%)`=col_double(),
  `HIV/AIDS - deaths`=col_double(),
  `HIV/AIDS - people living with HIV/AIDS`=col_double(),
  `Highways(km)`=col_double(),
  `Imports`=col_double(),
  `Industrial production growth rate(%)`=col_double(),
  `Infant mortality rate(deaths/1000 live births)`=col_double(),
  `Inflation rate (consumer prices)(%)`=col_double(),
  `Internet hosts`=col_double(),
  `Internet users`=col_double(),
  `Investment (gross fixed)(% of GDP)`=col_double(),
  `Labor force`=col_double(),
  `Life expectancy at birth(years)`=col_double(),
  `Military expenditures - dollar figure`=col_double(),
  `Military expenditures - percent of GDP(%)`=col_double(),
  `Natural gas - consumption(cu m)`=col_double(),
  `Natural gas - exports(cu m)`=col_double(),
  `Natural gas - imports(cu m)`=col_double(),
  `Natural gas - production(cu m)`=col_double(),
  `Natural gas - proved reserves(cu m)`=col_double(),
  `Oil - consumption(bbl/day)`=col_double(),
  `Oil - exports(bbl/day)`=col_double(),
  `Oil - imports(bbl/day)`=col_double(),
  `Oil - production(bbl/day)`=col_double(),
  `Oil - proved reserves(bbl)`=col_double(),
  `Population`=col_double(),
  `Railways(km)`=col_double(),
  `Public debt(% of GDP)`=col_double(),
  `Reserves of foreign exchange & gold`=col_double(),
  `Telephones - main lines in use`=col_double(),
  `Telephones - mobile cellular`=col_double(),
  `Total fertility rate(children born/woman)`=col_double(),
  `Unemployment rate(%)`=col_double()
))
factbook<-factbook[2:264,]
factbook
```




# Braden Griebel Individual Section: 

## East Africa Lake Data Lake Malawi

*It is unclear whether the BSi MAR is two seperate values. It seems that they are mostly different years, but there are some overlap of years with different values. So I graphed it two ways, first treating them as seperate vaariables then treating it as a single variable after I combined them. When combining them, I used the left most columns value when the two columns had different values that disagreed. There were not many of these values so it doesn't affect the overall trend significantly. I graphed the BSi against calander year since that made the graph more intuitive to understand. Graphing it against age would mean having time go from right to left, which is more confusing. *

```{r, warning=FALSE, message=FALSE}
malawi<-read_excel(path="East Africa lake data.xlsx",sheet="Malawi")
malawi<-malawi[-c(4,5)]
malawi1<-malawi[c(1:3)]
malawi2<-malawi[c(4:6)]
malawi1<-malawi1%>%select("age"=`Age, ybp`,"calender"=`Age (calender)...2`,"Bsi1"=`BSi MAR (mgSiO2/cm2y)...3`)
malawi2<-malawi2%>%select("age"=`Age, cal ybp`,"calender"=`Age (calender)...7`,"Bsi2"=`BSi MAR (mgSiO2/cm2y)...8`)
malawi1$age<-as.integer(malawi1$age)
malawi1$calender<-as.integer(malawi1$calender)
malawi2$age<-as.integer(malawi2$age)
malawi2$calender<-as.integer(malawi2$calender)
malawi1<-malawi1%>%filter(!is.na(age))
malawi2<-malawi2%>%filter(!is.na(age))


malawi<-full_join(malawi1,malawi2,by=c("calender","age"))


```


```{r, warning=FALSE, message=FALSE}
ggplot(malawi,aes(calender))+geom_point(aes(y=Bsi1),color="red")+geom_point(aes(y=Bsi2),color="blue")+geom_smooth(aes(y=Bsi1,color="Bsi1"))+
  geom_smooth(aes(y=Bsi2,color="Bsi2"))+labs(x="Year",y="BSi MAR (mgSiO2/cm2y)",title="BSi Over Time",caption="Taking BSi as seperate Variables")
```

```{r, warning=FALSE, message=FALSE}


malawi2<-malawi%>%unite(Bsi1,Bsi2,col="BSi",sep='_',na.rm=T)
malawi3<-malawi2[917:1655,]%>%separate(BSi,into=c(NA,"BSi"),sep="_")
malawi4<-malawi2[1:916,]%>%separate(BSi,into=c("BSi",NA),sep="_")
malawi2<-full_join(malawi3,malawi4)
malawi2$BSi<-as.double(malawi2$BSi)
malawi2<-malawi2%>%filter(!is.na(BSi))
ggplot(data=malawi2,aes(calender,BSi))+geom_point()+geom_smooth()+labs(x="Year",y="BSi MAR (mgSiO2/cm2y)",title="BSi Over Time", 
                                                                       caption="Combined BSi")

```


